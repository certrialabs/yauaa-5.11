#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2023 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:

 # Some of the HackerAttackVectors patterns have shown to be false positives
- set:
    name: 'HackerAttackVectorsFalsePositives'
    values:
    - 'MSIE or Firefox mutant' # Only on Daum robot
    # An idiot company that does not have a normal useragent but does have their email address in there.
    - 'scaninfo@paloaltonetworks.com'
    - 'scaninfo@expanseinc.com'


- lookup:
    name: 'HackerAttackVectors'
    map:
      # Shell scripting
      "() {"                  : "Code Injection"
      "('') {"                : "Code Injection"
      "$("                    : "Code Injection"
#      "${"                    : "Code Injection" # This one has exceptions --> Has separate rule

      # Apache Log4j RCE CVE-2021-44228
      "/Basic/Command/"       : "Code Injection" # ${jndi:ldap://195.54.160.149:12344/Basic/Command/Ba
      "${jndi:"               : "Code Injection" # ${jndi:ldap://195.54.160.149:12344/Basic/Command/Ba
      "${${"                  : "Code Injection" # ${${::-j}${::-n}${::-d}${::-i}
                                                 # ${${env:NaN:-j}ndi${env:NaN:-:}${env:NaN:-l}dap

      "{{"                    : "Code Injection"
      "}}"                    : "Code Injection"
      "curl "                 : "Code Injection"
      "wget "                 : "Code Injection"
      "bash'"                 : "Code Injection"
      "bash\""                : "Code Injection"
      "bash "                 : "Code Injection"
      "nslookup"              : "Code Injection"

      # Javascript/frontend scripting
      "<script"               : "Code Injection"
      "javascript:"           : "Code Injection"
      "<img"                  : "Code Injection"
      "onerror="              : "Code Injection"
      "eval("                 : "Code Injection"
      "atob("                 : "Code Injection"
      "assert("               : "Code Injection"
      "base64_decode("        : "Code Injection"
      ".*"                    : "Code Injection"

      #"xss"                   : "Code Injection" # This will match too much.
      "_xss_"                 : "Code Injection"
      "/xss/"                 : "Code Injection"

      # SQL
      "SELECT "               : "Code Injection"
      "SELECT("               : "Code Injection"
      "CASE WHEN"             : "Code Injection"
      "UNION ALL"             : "Code Injection"
      " OR "                  : "Code Injection"
      " OR NOT"               : "Code Injection"
      "WAITFOR "              : "Code Injection"
      "ORDER BY"              : "Code Injection"
      "FROM DUAL"             : "Code Injection"
      "DECLARE "              : "Code Injection"
      "VARCHAR"               : "Code Injection"
      "RLIKE "                : "Code Injection"
      "1=1"                   : "Code Injection"
      "PG_SLEEP("             : "Code Injection"
      "SLEEP("                : "Code Injection"

      # XML
      "<!ENTITY"              : "Code Injection"
      "xmlns"                 : "Code Injection"

      # Python
      "chr("                  : "Code Injection"
      "concat("               : "Code Injection"
      "Socket.gethostbyname"  : "Code Injection"
      "str("                  : "Code Injection"
      "__import__("           : "Code Injection"
      "gethostbyname("        : "Code Injection"
      "while("                : "Code Injection"
      "print("                : "Code Injection"
      "typeof"                : "Code Injection"
      "load_file"             : "Code Injection"

      # Java
      "toString("             : "Code Injection"
      "replace("              : "Code Injection"
      "replaceAll("           : "Code Injection"

      # Script retrieval sites
      "bxss.me"               : "Code Injection"
      "burp"                  : "Code Injection"
      "orator.net"            : "Code Injection"

      # Path Traversal
      "path:"                 : "Path Traversal"
      "file:"                 : "Path Traversal"
      # Unix style paths
      "../"                   : "Path Traversal"
      "/.."                   : "Path Traversal"
      "/./."                  : "Path Traversal"
      "..%2f"                 : "Path Traversal"
      "%2e%2e%2f"             : "Path Traversal"
      "%2e%2e/"               : "Path Traversal"
      # https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work
      "%C0%2F"                : "Path Traversal"
      "%C0%AF"                : "Path Traversal"
      # Windows style paths
      "..\\"                  : "Path Traversal"
      "\\.."                  : "Path Traversal"
      "..%5c"                 : "Path Traversal"
      "%2e%2e%5c"             : "Path Traversal"
      "%2e%2e\\"              : "Path Traversal"

      "#exec"                 : "Serverside execute"
      "#include"              : "Serverside include"

      # Tool specifics
      "JDatabaseDriverMysqli" : "Remote exec Joomla"

- lookup:
    name: 'HackerToolKits'
    map:
      "nessus"                : "Nessus"
      "netsparker"            : "Netsparker"
      "nmap"                  : "Nmap"
      "sqlmap"                : "Sqlmap"
      "OpenVAS"               : "OpenVAS"
      "OpenVAS-VT"            : "OpenVAS"
      "GoogleSecurityScanner" : "Google Security Scanner"
      "Fuzz Faster U Fool"    : "Fuzz Faster U Fool" # https://github.com/ffuf/ffuf

- set:
    name: 'AbnormalProductNames'
    values:
    - 'Mozlila'
    - 'Bulid'
    - 'Moblie'


- matcher:
    require:
    - 'IsNotInLookUpContains[HackerAttackVectorsFalsePositives; agent]'
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
    - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
#    - 'HackerToolkit                       :   999901 :"<<<null>>>"'
    - 'HackerAttackVector                  :  1000000 :LookUpContains[HackerAttackVectors;agent]'
    - 'RemarkablePattern                   :  1000000 :"Hacker"'

- matcher:
    require:
    - 'IsNull[agent.product.name?NormalProductNames]'
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
    - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
    - 'HackerToolkit                       :  1000000 :LookUpContains[HackerToolKits;agent]'
    - 'HackerAttackVector                  :   999901 :"<<<null>>>"'
    - 'RemarkablePattern                   :  1000000 :"Hacker"'

- matcher:
    require:
    - 'agent.product.name?AbnormalProductNames'
    extract:
    - '__Set_ALL_Fields__                  :   999800 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :   999899 :"Hacker"'
    - 'DeviceBrand                         :   999899 :"Hacker"'
    - 'DeviceName                          :   999899 :"Hacker"'
    - 'DeviceVersion                       :   999899 :"Hacker"'
    - 'OperatingSystemClass                :   999899 :"Hacker"'
    - 'OperatingSystemName                 :   999899 :"Hacker"'
    - 'OperatingSystemVersion              :   999899 :"Hacker"'
    - 'LayoutEngineClass                   :   999899 :"Hacker"'
    - 'LayoutEngineName                    :   999899 :"Hacker"'
    - 'LayoutEngineVersion                 :   999899 :"Hacker"'
    - 'AgentClass                          :   999899 :"Hacker"'
    - 'AgentName                           :   999899 :"Hacker"'
    - 'AgentVersion                        :   999899 :"Hacker"'
    - 'AgentInformationUrl                 :   999899 :"<<<null>>>"'
    - 'AgentInformationEmail               :   999899 :"<<<null>>>"'
    - 'HackerToolkit                       :   999899 :"<<<null>>>"'
    - 'HackerAttackVector                  :   999801 :"<<<null>>>"'
    - 'RemarkablePattern                   :   999899 :"Bad Words"'


- matcher:
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
    - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
    - 'HackerToolkit                       :  1000000 :LookUpContains[HackerToolKits;agent.product.name]'
    - 'HackerAttackVector                  :   999901 :"<<<null>>>"'
    - 'RemarkablePattern                   :  1000000 :"Hacker"'

- matcher:
    extract:
      - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
      - 'DeviceClass                         :  1000000 :"Hacker"'
      - 'DeviceBrand                         :  1000000 :"Hacker"'
      - 'DeviceName                          :  1000000 :"Hacker"'
      - 'DeviceVersion                       :  1000000 :"Hacker"'
      - 'OperatingSystemClass                :  1000000 :"Hacker"'
      - 'OperatingSystemName                 :  1000000 :"Hacker"'
      - 'OperatingSystemVersion              :  1000000 :"Hacker"'
      - 'LayoutEngineClass                   :  1000000 :"Hacker"'
      - 'LayoutEngineName                    :  1000000 :"Hacker"'
      - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
      - 'AgentClass                          :  1000000 :"Hacker"'
      - 'AgentName                           :  1000000 :"Hacker"'
      - 'AgentVersion                        :  1000000 :"Hacker"'
      - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
      - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
      - 'HackerToolkit                       :  1000000 :LookUpContains[HackerToolKits;agent.product.comments]'
      - 'HackerAttackVector                  :   999901 :"<<<null>>>"'
      - 'RemarkablePattern                   :  1000000 :"Hacker"'


- matcher:
    require:
    - 'agent{"OR "'
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'HackerAttackVector                  :  1000000 :"Code Injection"'
    - 'RemarkablePattern                   :  1000000 :"Hacker"'


# If there are NO products found this is either manipulated or a Hacker.
- matcher:
    require:
    - 'IsNull[agent.product]'
    - 'IsNull[agent.url]'
    extract:
    - 'DeviceClass                         :       10 :"Hacker"'
    - 'DeviceName                          :       10 :"Hacker"'
    - 'DeviceBrand                         :       10 :"Hacker"'
    - 'DeviceVersion                       :       10 :"Hacker"'
    - 'OperatingSystemClass                :       10 :"Hacker"'
    - 'OperatingSystemName                 :       10 :"Hacker"'
    - 'OperatingSystemVersion              :       10 :"Hacker"'
    - 'LayoutEngineClass                   :       10 :"Hacker"'
    - 'LayoutEngineName                    :       10 :"Hacker"'
    - 'LayoutEngineVersion                 :       10 :"Hacker"'
    - 'AgentClass                          :       10 :"Hacker"'
    - 'AgentName                           :       10 :"Hacker"'
    - 'AgentVersion                        :       10 :"Hacker"'
    - 'HackerAttackVector                  :       10 :"<<<null>>>"'
    - 'HackerToolkit                       :       10 :"<<<null>>>"'
    - 'RemarkablePattern                   :       10 :"Hacker"'

# If there are NO products found this is either manipulated or a Hacker.
- matcher:
    require:
    - 'agent.(1)text'
    - 'IsNull[agent.(1)text^>]'
    extract:
    - 'DeviceClass                         :       10 :"Hacker"'
    - 'DeviceName                          :       10 :"Hacker"'
    - 'DeviceBrand                         :       10 :"Hacker"'
    - 'DeviceVersion                       :       10 :"Hacker"'
    - 'OperatingSystemClass                :       10 :"Hacker"'
    - 'OperatingSystemName                 :       10 :"Hacker"'
    - 'OperatingSystemVersion              :       10 :"Hacker"'
    - 'LayoutEngineClass                   :       10 :"Hacker"'
    - 'LayoutEngineName                    :       10 :"Hacker"'
    - 'LayoutEngineVersion                 :       10 :"Hacker"'
    - 'AgentClass                          :       10 :"Hacker"'
    - 'AgentName                           :       10 :"Hacker"'
    - 'AgentVersion                        :       10 :"Hacker"'
    - 'HackerAttackVector                  :       10 :"<<<null>>>"'
    - 'HackerToolkit                       :       10 :"<<<null>>>"'
    - 'RemarkablePattern                   :       10 :"Hacker"'


# NEVER happens because of Java code that "Fixes" these
#- matcher:
#    require:
#    - 'agent{"("'
#    extract:
#    - 'DeviceClass                         :       10 :"Hacker"'
#    - 'DeviceName                          :       10 :"Hacker"'
#    - 'DeviceBrand                         :       10 :"Hacker"'
#    - 'DeviceVersion                       :       10 :"Hacker"'
#    - 'OperatingSystemClass                :       10 :"Hacker"'
#    - 'OperatingSystemName                 :       10 :"Hacker"'
#    - 'OperatingSystemVersion              :       10 :"Hacker"'
#    - 'LayoutEngineClass                   :       10 :"Hacker"'
#    - 'LayoutEngineName                    :       10 :"Hacker"'
#    - 'LayoutEngineVersion                 :       10 :"Hacker"'
#    - 'AgentClass                          :       10 :"Hacker"'
#    - 'AgentName                           :       10 :"Hacker"'
#    - 'AgentVersion                        :       10 :"Hacker"'
#    - 'HackerAttackVector                  :       10 :"<<<null>>>"'
#    - 'HackerToolkit                       :       10 :"<<<null>>>"'
#    - 'RemarkablePattern                   :       10 :"Hacker"'


# If there is ONLY a product name and nothing else then this is either manipulated or a Hacker.
- matcher:
    require:
    - 'IsNull[agent.(1)product.(1)version]'
    - 'IsNull[agent.(1)product.(1)comments]'
    - 'IsNull[agent.url]'
    - 'IsNull[agent.product]'
    extract:
    - 'DeviceClass                         :       10 :"Hacker"'
    - 'DeviceName                          :       10 :"Hacker"'
    - 'DeviceBrand                         :       10 :"Hacker"'
    - 'DeviceVersion                       :       10 :"Hacker"'
    - 'OperatingSystemClass                :       10 :"Hacker"'
    - 'OperatingSystemName                 :       10 :"Hacker"'
    - 'OperatingSystemVersion              :       10 :"Hacker"'
    - 'LayoutEngineClass                   :       10 :"Hacker"'
    - 'LayoutEngineName                    :       10 :"Hacker"'
    - 'LayoutEngineVersion                 :       10 :"Hacker"'
    - 'AgentClass                          :       10 :"Hacker"'
    - 'AgentName                           :       10 :"Hacker"'
    - 'AgentVersion                        :       10 :"Hacker"'
    - 'HackerAttackVector                  :       10 :"<<<null>>>"'
    - 'HackerToolkit                       :       10 :"<<<null>>>"'
    - 'RemarkablePattern                   :       10 :"Hacker"'


- matcher:
    require:
    - 'agent~"${"'
    - 'IsNull[agent.(1-2)product.(1)version="${pom.version}"]'
    - 'IsNull[agent.(1-2)product.(1)comments.entry.(1-2)product.(1)version="${pom.version}"]'
    extract:
    - '__Set_ALL_Fields__                  :     4999 :"<<<null>>>"' # Must be at least 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :    10000 :"Hacker"'
    - 'DeviceBrand                         :    10000 :"Hacker"'
    - 'DeviceName                          :    10000 :"Hacker"'
    - 'DeviceVersion                       :    10000 :"Hacker"'
    - 'OperatingSystemClass                :    10000 :"Hacker"'
    - 'OperatingSystemName                 :    10000 :"Hacker"'
    - 'OperatingSystemVersion              :    10000 :"Hacker"'
    - 'LayoutEngineClass                   :    10000 :"Hacker"'
    - 'LayoutEngineName                    :    10000 :"Hacker"'
    - 'LayoutEngineVersion                 :    10000 :"Hacker"'
    - 'AgentClass                          :    10000 :"Hacker"'
    - 'AgentName                           :    10000 :"Hacker"'
    - 'AgentVersion                        :    10000 :"Hacker"'
    - 'HackerAttackVector                  :     5000 :"<<<null>>>"'
    - 'HackerToolkit                       :     5000 :"<<<null>>>"'
    - 'RemarkablePattern                   :    10000 :"Hacker"'


- lookup:
    name: 'IfAllMissingThenHacker'
    map:
      "a" : "a"
      "e" : "e"
      "o" : "o"
      "u" : "u"
      "i" : "i"
      "/" : "/"

- matcher:
    require:
    - 'IsNull[LookUpContains[IfAllMissingThenHacker;agent]]'
    extract:
    - 'DeviceClass                         :        9 :"Hacker"'
    - 'DeviceName                          :        9 :"Hacker"'
    - 'DeviceBrand                         :        9 :"Hacker"'
    - 'DeviceVersion                       :        9 :"Hacker"'
    - 'OperatingSystemClass                :        9 :"Hacker"'
    - 'OperatingSystemName                 :        9 :"Hacker"'
    - 'OperatingSystemVersion              :        9 :"Hacker"'
    - 'LayoutEngineClass                   :        9 :"Hacker"'
    - 'LayoutEngineName                    :        9 :"Hacker"'
    - 'LayoutEngineVersion                 :        9 :"Hacker"'
    - 'LayoutEngineVersionMajor            :        9 :"Hacker"'
    - 'AgentClass                          :        9 :"Hacker"'
    - 'AgentName                           :        9 :"Hacker"'
    - 'AgentVersion                        :        9 :"Hacker"'
    - 'AgentVersionMajor                   :        9 :"Hacker"'
    - 'AgentNameVersion                    :        9 :"Hacker"'
    - 'AgentNameVersionMajor               :        9 :"Hacker"'
    - 'HackerAttackVector                  :        9 :"Fuzzing"'
    - 'HackerToolkit                       :        9 :"<<<null>>>"'
    - 'RemarkablePattern                   :        9 :"Hacker"'


# https://www.cirt.net/node/89
# Nikto is an open source web server scanner which performs comprehensive tests against web servers for multiple items,
#   including over 6500 potentially dangerous files/CGIs, checks for outdated versions of over 1200 servers,
#   and version specific problems on over 270 servers.
# https://en.wikipedia.org/wiki/Nikto_Web_Scanner


- matcher:
    variable:
    - 'Nikto                               :agent.(1)product.(1)comments.(1)entry.(1)product.name="Nikto"'
    - 'Evasions                            :agent.(1)product.(2)comments.(1)entry.(1)keyvalue.(1)key="Evasions"'
    - 'Test                                :agent.(1)product.(3)comments.(1)entry.(1)keyvalue.(1)key="Test"'
    extract:
    - 'DeviceClass                         :    10000 :"Hacker"'
    - 'DeviceBrand                         :    10000 :"Hacker"'
    - 'DeviceName                          :    10000 :"Hacker"'
    - 'DeviceVersion                       :    10000 :"Hacker"'
    - 'OperatingSystemClass                :    10000 :"Hacker"'
    - 'OperatingSystemName                 :    10000 :"Hacker"'
    - 'OperatingSystemVersion              :    10000 :"Hacker"'
    - 'LayoutEngineClass                   :    10000 :"Hacker"'
    - 'LayoutEngineName                    :    10000 :"Hacker"'
    - 'LayoutEngineVersion                 :    10000 :"Hacker"'
    - 'AgentClass                          :    10000 :"Hacker"'
    - 'AgentName                           :    10000 :"Nikto"'
    - 'AgentVersion                        :    10000 :@Nikto^.version'
    - 'HackerAttackVector                  :    10000 :Concat["Nikto test:";@Test^.value]'
    - 'HackerToolkit                       :        1 :"Nikto"'
    - 'RemarkablePattern                   :    10000 :"Hacker"'


- test:
    input:
      user_agent_string: 'Mozilla/5.00 (Nikto/2.1.5) (Evasions:None) (Test:map_codes)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Nikto'
      AgentVersion                         : '2.1.5'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Nikto 2.1.5'
      AgentNameVersionMajor                : 'Nikto 2'
      HackerAttackVector                   : 'Nikto test:map_codes'
      HackerToolkit                        : 'Nikto'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      user_agent_string: 'Mozilla/5.00 (Nikto/2.1.5) (Evasions:None) (Test:000964)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Nikto'
      AgentVersion                         : '2.1.5'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Nikto 2.1.5'
      AgentNameVersionMajor                : 'Nikto 2'
      HackerAttackVector                   : 'Nikto test:000964'
      HackerToolkit                        : 'Nikto'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      user_agent_string: 'Mozilla/5.00 (Nikto/2.1.5) (Evasions:None) (Test:cgi dir check)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Nikto'
      AgentVersion                         : '2.1.5'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Nikto 2.1.5'
      AgentNameVersionMajor                : 'Nikto 2'
      HackerAttackVector                   : 'Nikto test:cgi dir check'
      HackerToolkit                        : 'Nikto'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      user_agent_string: 'Mozilla/5.00 (Nikto/2.1.5) (Evasions:None) (Test:embedded detection)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Nikto'
      AgentVersion                         : '2.1.5'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Nikto 2.1.5'
      AgentNameVersionMajor                : 'Nikto 2'
      HackerAttackVector                   : 'Nikto test:embedded detection'
      HackerToolkit                        : 'Nikto'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      user_agent_string: 'Mozilla/5.00 (Nikto/2.1.5) (Evasions:None) (Test:multiple_index)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Nikto'
      AgentVersion                         : '2.1.5'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'Nikto 2.1.5'
      AgentNameVersionMajor                : 'Nikto 2'
      HackerAttackVector                   : 'Nikto test:multiple_index'
      HackerToolkit                        : 'Nikto'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentInformationUrl                  : 'https://nmap.org/book/nse.html'
      HackerToolkit                        : 'Nmap'
      HackerAttackVector                   : 'Unknown'
      RemarkablePattern                    : 'Hacker'


# This EXACT version is really nmap
# https://nmap.org/nsedoc/lib/anyconnect.html
- matcher:
    require:
    - 'agent="AnyConnect Darwin_i386 3.1.05160"'
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'HackerToolkit                       :  1000000 :"Nmap"'
    - 'HackerAttackVector                  :   999901 :"<<<null>>>"'
    - 'RemarkablePattern                   :  1000000 :"Hacker"'


  # This EXACT version is really nmap
  # https://nmap.org/nsedoc/lib/anyconnect.html
- test:
    input:
      user_agent_string: 'AnyConnect Darwin_i386 3.1.05160'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerToolkit                        : 'Nmap'
      RemarkablePattern                    : 'Hacker'


# OpenVAS – Open Vulnerability Assessment Scanner
# https://www.openvas.org/
- test:
    input:
      User-Agent  : 'Mozilla/5.0 [en] (X11, U; OpenVAS-VT 9.0.3)'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerToolkit                        : 'OpenVAS'
      RemarkablePattern                    : 'Hacker'


## https://console.cloud.google.com/security/web-scanner
- test:
    input:
      User-Agent  : 'Mozilla/5.0 (X11; Linux x86_64; GoogleSecurityScanner Google-HTTP-Java-Client) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.72 Safari/537.36 (scan 4592796119236608, run 5605990237962240) To_stop_this_scan_visit_https://console.cloud.google.com/security/web-scanner'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      AgentInformationUrl                  : '//console.cloud.google.com/security/web-scanner'
      HackerToolkit                        : 'Google Security Scanner'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      User-Agent  : 'Fuzz Faster U Fool v1.4.1-dev'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerToolkit                        : 'Fuzz Faster U Fool'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      User-Agent  : 'Fuzz Faster U Fool v1.5.0 Kali Exclusive <3'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerToolkit                        : 'Fuzz Faster U Fool'
      RemarkablePattern                    : 'Hacker'



- test:
    input:
      User-Agent                           : '@@VI1wa'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      User-Agent                           : '@@vpaCk'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Hacker'


- test:
    input:
      User-Agent                           : '@@vPVIf'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Hacker'


# Has the deliberate misspelled words 'Mozlila', 'Bulid' and 'Moblie'
# And the behaviour is clearly that of a hacker.
- test:
    input:
      User-Agent                           : 'Mozlila/5.0 (Linux; Android 7.0; SM-G892A Bulid/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/60.0.3112.107 Moblie Safari/537.36'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Bad Words'


# Note the modified CPU indicator; only used by Hackers.
- matcher:
    variable:
     - 'LinuxVersion: agent.(1-2)product.(1)comments.entry.(1)product.(1)name="Linux"^.version'
    require:
     - '@LinuxVersion{"x"'
     - '@LinuxVersion}"_64"'
     - 'IsNull[LookUp[CPUArchitectures;@LinuxVersion]]'
    extract:
      - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
      - 'DeviceClass                         :  1000000 :"Hacker"'
      - 'DeviceBrand                         :  1000000 :"Hacker"'
      - 'DeviceName                          :  1000000 :"Hacker"'
      - 'DeviceVersion                       :  1000000 :"Hacker"'
      - 'OperatingSystemClass                :  1000000 :"Hacker"'
      - 'OperatingSystemName                 :  1000000 :"Hacker"'
      - 'OperatingSystemVersion              :  1000000 :"Hacker"'
      - 'LayoutEngineClass                   :  1000000 :"Hacker"'
      - 'LayoutEngineName                    :  1000000 :"Hacker"'
      - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
      - 'AgentClass                          :  1000000 :"Hacker"'
      - 'AgentName                           :  1000000 :"Hacker"'
      - 'AgentVersion                        :  1000000 :"Hacker"'
      - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
      - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
      - 'RemarkablePattern                   :  1000000 :"Fake CPU Architecture"'


- matcher:
    require:
    - 'agent.product.name="Edge"'
    - 'agent.(1)product.(1)comments.(1)entry="X11"'
    - 'IsNull[agent.(1)product.(1)comments.(2)entry]' # Only a SINGLE entry
    - 'IsNull[agent.product.name="Chrome"]'
    extract:
    - '__Set_ALL_Fields__                  :   999900 :"<<<null>>>"' # Must be 1 lower than the rest (or you will wipe yourself too)
    - 'DeviceClass                         :  1000000 :"Hacker"'
    - 'DeviceBrand                         :  1000000 :"Hacker"'
    - 'DeviceName                          :  1000000 :"Hacker"'
    - 'DeviceVersion                       :  1000000 :"Hacker"'
    - 'OperatingSystemClass                :  1000000 :"Hacker"'
    - 'OperatingSystemName                 :  1000000 :"Hacker"'
    - 'OperatingSystemVersion              :  1000000 :"Hacker"'
    - 'LayoutEngineClass                   :  1000000 :"Hacker"'
    - 'LayoutEngineName                    :  1000000 :"Hacker"'
    - 'LayoutEngineVersion                 :  1000000 :"Hacker"'
    - 'AgentClass                          :  1000000 :"Hacker"'
    - 'AgentName                           :  1000000 :"Hacker"'
    - 'AgentVersion                        :  1000000 :"Hacker"'
    - 'AgentInformationUrl                 :  1000000 :"<<<null>>>"'
    - 'AgentInformationEmail               :  1000000 :"<<<null>>>"'
    - 'RemarkablePattern                   :  1000000 :"Fake Edge like useragent"'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (X11) AppleWebKit/62.41 (KHTML, like Gecko) Edge/17.10859 Safari/452.6'
    expected:
      DeviceClass                          : 'Hacker'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Fake Edge like useragent'


