#
# Yet Another UserAgent Analyzer
# Copyright (C) 2013-2023 Niels Basjes
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an AS IS BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
config:


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (masking-agent; rv:25.0) Gecko/20100101 Firefox/25.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Firefox OS'
      OperatingSystemVersion               : '25.0'
      OperatingSystemVersionMajor          : '25'
      OperatingSystemNameVersion           : 'Firefox OS 25.0'
      OperatingSystemNameVersionMajor      : 'Firefox OS 25'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '25.0'
      LayoutEngineVersionMajor             : '25'
      LayoutEngineBuild                    : '20100101'
      LayoutEngineNameVersion              : 'Gecko 25.0'
      LayoutEngineNameVersionMajor         : 'Gecko 25'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '25.0'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Firefox 25.0'
      AgentNameVersionMajor                : 'Firefox 25'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (000000000; 00000 000 00 0 000000) DDDDDDDDDDDDDDDDDDDD DDDDDDD DDDD DDDDDD DDDDDDDDDDDDD DDDDDDDDDDDDDDD'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Unknown'
      OperatingSystemName                  : 'Unknown'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Unknown ??'
      OperatingSystemNameVersionMajor      : 'Unknown ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : '00000'
      AgentVersion                         : '000'
      AgentVersionMajor                    : '000'
      AgentNameVersion                     : '00000 000'
      AgentNameVersionMajor                : '00000 000'
      RemarkablePattern                    : 'Anonymized'

# https://www.abelssoft.de/en/windows/security-privacy/antibrowserspy#functions
# The UserAgent text is changed regularly so that the "browser fingerprint" can no longer be assigned.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.2; rv:28.0) Gecko/20100101 Firefox/28.0 anonymized by Abelssoft 462766946'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '28.0'
      LayoutEngineVersionMajor             : '28'
      LayoutEngineNameVersion              : 'Gecko 28.0'
      LayoutEngineNameVersionMajor         : 'Gecko 28'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '28.0'
      AgentVersionMajor                    : '28'
      AgentNameVersion                     : 'Firefox 28.0'
      AgentNameVersionMajor                : 'Firefox 28'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.22 anonymized by Abelssoft 1392034350'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '39.0.2171.95'
      AgentVersionMajor                    : '39'
      AgentNameVersion                     : 'Chrome 39.0.2171.95'
      AgentNameVersionMajor                : 'Chrome 39'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'Firefox/36.0.3 (x86 en-US); anonymized by Abelssoft 1222574064'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Unknown'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'x86'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Firefox OS'
      OperatingSystemVersion               : '36.0.3'
      OperatingSystemVersionMajor          : '36'
      OperatingSystemNameVersion           : 'Firefox OS 36.0.3'
      OperatingSystemNameVersionMajor      : 'Firefox OS 36'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'Firefox'
      AgentVersion                         : '36.0.3'
      AgentVersionMajor                    : '36'
      AgentNameVersion                     : 'Firefox 36.0.3'
      AgentNameVersionMajor                : 'Firefox 36'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      RemarkablePattern                    : 'Anonymized'


- test: # This one has parsing problems, this is the best possible at this moment.
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.2; rv:35.0 () Gecko/20100101 Firefox/35.0 ( anonymized by Abelssoft 152378206'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Mozilla'
      LayoutEngineVersion                  : '5.0'
      LayoutEngineVersionMajor             : '5'
      LayoutEngineNameVersion              : 'Mozilla 5.0'     # We would have expected Gecko/20100101 here ...
      LayoutEngineNameVersionMajor         : 'Mozilla 5'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '35.0'
      AgentVersionMajor                    : '35'
      AgentNameVersion                     : 'Firefox 35.0'
      AgentNameVersionMajor                : 'Firefox 35'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; anonymized by Abelssoft 423514663; BTRS102280; GTB7.5; anonymized by Abelssoft 423514663; .NET CLR 2.0.50727; .NET4.0C; InfoPath.3; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0E)'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Trident'
      LayoutEngineVersion                  : '4.0'
      LayoutEngineVersionMajor             : '4'
      LayoutEngineNameVersion              : 'Trident 4.0'
      LayoutEngineNameVersionMajor         : 'Trident 4'
      AgentClass                           : 'Browser'
      AgentName                            : 'Internet Explorer'
      AgentVersion                         : '8.0'
      AgentVersionMajor                    : '8'
      AgentNameVersion                     : 'Internet Explorer 8.0'
      AgentNameVersionMajor                : 'Internet Explorer 8'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android 2.3; en-us) AppleWebKit/999+ (KHTML, like Gecko) Safari/999.9'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '2.3'
      OperatingSystemVersionMajor          : '2'
      OperatingSystemNameVersion           : 'Android 2.3'
      OperatingSystemNameVersionMajor      : 'Android 2'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '999'
      LayoutEngineVersionMajor             : '999'
      LayoutEngineNameVersion              : 'AppleWebKit 999'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 999'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '999.9'
      AgentVersionMajor                    : '999'
      AgentNameVersion                     : 'Safari 999.9'
      AgentNameVersionMajor                : 'Safari 999'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'No such version: AppleWebKit'

# These have been manipulated to have multiple user agents.
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 10.0; WOW64; IA64; en) AppleWebKit/599.0+ Chrome/48.2564.0.82 Maxthon/4.9.0 QupZilla/1.8.9'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '48.2564'
      LayoutEngineVersionMajor             : '48'
      LayoutEngineNameVersion              : 'Blink 48.2564'
      LayoutEngineNameVersionMajor         : 'Blink 48'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '1.8.9'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'QupZilla 1.8.9'
      AgentNameVersionMajor                : 'QupZilla 1'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 10.0; WOW64; IA64; en) AppleWebKit/599.0+ Chrome/55.0.2883.0.87 Maxthon/5.0.2 QupZilla/2.0.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '55.0'
      LayoutEngineVersionMajor             : '55'
      LayoutEngineNameVersion              : 'Blink 55.0'
      LayoutEngineNameVersionMajor         : 'Blink 55'
      AgentClass                           : 'Browser'
      AgentName                            : 'QupZilla'
      AgentVersion                         : '2.0.2'
      AgentVersionMajor                    : '2'
      AgentNameVersion                     : 'QupZilla 2.0.2'
      AgentNameVersionMajor                : 'QupZilla 2'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 5.1; U; WOW64; IA64; en) AppleWebKit/599.0+ (KHTML, like Gecko) Maxthon/3.0 Chrome/41.0.2272.89 Safari/537.36 OPR/28.0.1750.40 QupZilla/1.8.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '41.0'
      LayoutEngineVersionMajor             : '41'
      LayoutEngineNameVersion              : 'Blink 41.0'
      LayoutEngineNameVersionMajor         : 'Blink 41'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '28.0.1750.40'
      AgentVersionMajor                    : '28'
      AgentNameVersion                     : 'Opera 28.0.1750.40'
      AgentNameVersionMajor                : 'Opera 28'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 6.1; U; WOW64; IA64; en) AppleWebKit/599.0+ (KHTML, like Gecko) Maxthon/4.4.3.4000 Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60 QupZilla/1.8.4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '39.0'
      LayoutEngineVersionMajor             : '39'
      LayoutEngineNameVersion              : 'Blink 39.0'
      LayoutEngineNameVersionMajor         : 'Blink 39'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '26.0.1656.60'
      AgentVersionMajor                    : '26'
      AgentNameVersion                     : 'Opera 26.0.1656.60'
      AgentNameVersionMajor                : 'Opera 26'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 6.1; U; WOW64; IA64; en) AppleWebKit/599.0+ (KHTML, like Gecko) Maxthon/4.4.8.1000 Chrome/48.2564.0.109 Safari/537.36 OPR/35.0.2066.37 QupZilla/1.8.9'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '48.2564'
      LayoutEngineVersionMajor             : '48'
      LayoutEngineNameVersion              : 'Blink 48.2564'
      LayoutEngineNameVersionMajor         : 'Blink 48'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '35.0.2066.37'
      AgentVersionMajor                    : '35'
      AgentNameVersion                     : 'Opera 35.0.2066.37'
      AgentNameVersionMajor                : 'Opera 35'
      AgentLanguage                        : 'English'
      AgentLanguageCode                    : 'en'
      AgentSecurity                        : 'Strong security'


- test:
    input:
      user_agent_string: 'Mozilla/5.0 (compatible; Windows NT 6.3; U; WOW64; IA64; YB/3.5.3; Trident/8.0; rv:550) AppleWebKit/599.0+ (KHTML, like Gecko) Chrome/49.0.2612.0 Safari/537.36 OPR/36.0.2130.29 QupZilla/1.8.6'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel Itanium 64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8.1'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8.1'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '49.0'
      LayoutEngineVersionMajor             : '49'
      LayoutEngineNameVersion              : 'Blink 49.0'
      LayoutEngineNameVersionMajor         : 'Blink 49'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '36.0.2130.29'
      AgentVersionMajor                    : '36'
      AgentNameVersion                     : 'Opera 36.0.2130.29'
      AgentNameVersionMajor                : 'Opera 36'
      AgentSecurity                        : 'Strong security'


# Version 999 ... yeah right
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; U; Android; en-us) AppleWebKit/999+ (KHTML, like Gecko) Safari/999.9'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Android ??'
      OperatingSystemNameVersionMajor      : 'Android ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '999'
      LayoutEngineVersionMajor             : '999'
      LayoutEngineNameVersion              : 'AppleWebKit 999'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 999'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '999.9'
      AgentVersionMajor                    : '999'
      AgentNameVersion                     : 'Safari 999.9'
      AgentNameVersionMajor                : 'Safari 999'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'No such version: AppleWebKit'


- test: # This seems a bit messy, but given the input the best possible
    input:
      user_agent_string: 'My custom user-agent'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      HackerAttackVector                   : 'Unknown'
      HackerToolkit                        : 'Unknown'
      RemarkablePattern                    : 'Anonymized'


# This useragent was retrieved via https://googleweblight.com/i?u=https://try.yauaa.basjes.nl
# using Firefox 68 on Ubuntu 16.04. Real useragent:    Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 4.2.1; en-us; Nexus 5 Build/JOP40D) AppleWebKit/535.19 (KHTML, like Gecko; googleweblight) Chrome/38.0.1025.166 Mobile Safari/535.19'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Google Weblight'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '4.2.1'
      OperatingSystemVersionMajor          : '4'
      OperatingSystemNameVersion           : 'Android 4.2.1'
      OperatingSystemNameVersionMajor      : 'Android 4'
      OperatingSystemVersionBuild          : 'JOP40D'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '38.0'
      LayoutEngineVersionMajor             : '38'
      LayoutEngineNameVersion              : 'Blink 38.0'
      LayoutEngineNameVersionMajor         : 'Blink 38'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '38.0.1025.166'
      AgentVersionMajor                    : '38'
      AgentNameVersion                     : 'Chrome 38.0.1025.166'
      AgentNameVersionMajor                : 'Chrome 38'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.1.7 Safari/XSSN77UVZ'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.9.3'
      OperatingSystemVersionMajor          : '10.9'
      OperatingSystemNameVersion           : 'Mac OS 10.9.3'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.75.14'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.75.14'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.1.7'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.1.7'
      AgentNameVersionMajor                : 'Safari 7'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.1.7 Safari/CXPXSSDKA'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'Intel'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.9.3'
      OperatingSystemVersionMajor          : '10.9'
      OperatingSystemNameVersion           : 'Mac OS 10.9.3'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.9'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.75.14'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.75.14'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Safari'
      AgentVersion                         : '7.1.7'
      AgentVersionMajor                    : '7'
      AgentNameVersion                     : 'Safari 7.1.7'
      AgentNameVersionMajor                : 'Safari 7'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.8677.505 Safari/537.36 Edg/1DGWMNWXSSP'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '85.0'
      LayoutEngineVersionMajor             : '85'
      LayoutEngineNameVersion              : 'Blink 85.0'
      LayoutEngineNameVersionMajor         : 'Blink 85'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '1DGWMNWXSSP'
      AgentVersionMajor                    : '1DGWMNWXSSP'
      AgentNameVersion                     : 'Edge 1DGWMNWXSSP'
      AgentNameVersionMajor                : 'Edge 1DGWMNWXSSP'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.7164.687 Safari/DAXSSU'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '86.0'
      LayoutEngineVersionMajor             : '86'
      LayoutEngineNameVersion              : 'Blink 86.0'
      LayoutEngineNameVersionMajor         : 'Blink 86'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '86.0.7164.687'
      AgentVersionMajor                    : '86'
      AgentNameVersion                     : 'Chrome 86.0.7164.687'
      AgentNameVersionMajor                : 'Chrome 86'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:80.0) Gecko/20100101 Firefox/5XSS'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows 7'
      OperatingSystemNameVersionMajor      : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '80.0'
      LayoutEngineVersionMajor             : '80'
      LayoutEngineNameVersion              : 'Gecko 80.0'
      LayoutEngineNameVersionMajor         : 'Gecko 80'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '5XSS'
      AgentVersionMajor                    : '5XSS'
      AgentNameVersion                     : 'Firefox 5XSS'
      AgentNameVersionMajor                : 'Firefox 5XSS'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/HXSS'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '78.0'
      LayoutEngineVersionMajor             : '78'
      LayoutEngineNameVersion              : 'Gecko 78.0'
      LayoutEngineNameVersionMajor         : 'Gecko 78'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : 'HXSS'
      AgentVersionMajor                    : 'HXSS'
      AgentNameVersion                     : 'Firefox HXSS'
      AgentNameVersionMajor                : 'Firefox HXSS'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0 TO-Browser/TOB7.68.0.2 anonymized by Abelssoft'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '68.0'
      LayoutEngineVersionMajor             : '68'
      LayoutEngineNameVersion              : 'Gecko 68.0'
      LayoutEngineNameVersionMajor         : 'Gecko 68'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'TO-Browser'
      AgentVersion                         : 'TOB7.68.0.2'
      AgentVersionMajor                    : 'TOB7'
      AgentNameVersion                     : 'TO-Browser TOB7.68.0.2'
      AgentNameVersionMajor                : 'TO-Browser TOB7'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.2914.144 Safari/537.36 Edg/BOTXMTJFVV4'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '85.0'
      LayoutEngineVersionMajor             : '85'
      LayoutEngineNameVersion              : 'Blink 85.0'
      LayoutEngineNameVersionMajor         : 'Blink 85'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : 'BOTXMTJFVV4'
      AgentVersionMajor                    : 'BOTXMTJFVV4'
      AgentNameVersion                     : 'Edge BOTXMTJFVV4'
      AgentNameVersionMajor                : 'Edge BOTXMTJFVV4'
      RemarkablePattern                    : 'Not a version'

# Manipulated nonsense version --> NOT Hacker (Nmap)
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.3555.887 Safari/NMAP4H'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '84.0'
      LayoutEngineVersionMajor             : '84'
      LayoutEngineNameVersion              : 'Blink 84.0'
      LayoutEngineNameVersionMajor         : 'Blink 84'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '84.0.3555.887'
      AgentVersionMajor                    : '84'
      AgentNameVersion                     : 'Chrome 84.0.3555.887'
      AgentNameVersionMajor                : 'Chrome 84'
      RemarkablePattern                    : 'Not a version'


# Manipulated nonsense version --> NOT Hacker (Nmap)
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.1126.742 Safari/537.36 OPR/43ENDRNMAP1GSITEP'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '84.0'
      LayoutEngineVersionMajor             : '84'
      LayoutEngineNameVersion              : 'Blink 84.0'
      LayoutEngineNameVersionMajor         : 'Blink 84'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '43ENDRNMAP1GSITEP'
      AgentVersionMajor                    : '43ENDRNMAP1GSITEP'
      AgentNameVersion                     : 'Opera 43ENDRNMAP1GSITEP'
      AgentNameVersionMajor                : 'Opera 43ENDRNMAP1GSITEP'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Opera/9.99 X11; CrOS i686 3912.101.0 Presto/2.2.2 Version/55.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Chromebook'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel i686'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Chrome OS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Chrome OS ??'
      OperatingSystemNameVersionMajor      : 'Chrome OS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.2.2'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.2.2'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '55.0'
      AgentVersionMajor                    : '55'
      AgentNameVersion                     : 'Opera 55.0'
      AgentNameVersionMajor                : 'Opera 55'
      RemarkablePattern                    : 'No such version: Opera'


- test:
    input:
      User-Agent                           : 'Opera/9.99.(X11; Linux x86_64; as-IN) Presto/2.9.182 Version/11.00'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Linux ??'
      OperatingSystemNameVersionMajor      : 'Linux ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.9.182'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.9.182'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '11.00'
      AgentVersionMajor                    : '11'
      AgentNameVersion                     : 'Opera 11.00'
      AgentNameVersionMajor                : 'Opera 11'
      AgentLanguage                        : 'Assamese (India)'
      AgentLanguageCode                    : 'as-in'
      RemarkablePattern                    : 'No such version: Opera'


- test:
    input:
      User-Agent                           : 'Opera/9.99 X11; Mageia; Linux x86_64; rv:10.0.9 Presto/2.6.30 Version/68.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mageia'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Mageia ??'
      OperatingSystemNameVersionMajor      : 'Mageia ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.6.30'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.6.30'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '68.0'
      AgentVersionMajor                    : '68'
      AgentNameVersion                     : 'Opera 68.0'
      AgentNameVersionMajor                : 'Opera 68'
      RemarkablePattern                    : 'No such version: Opera'


- test:
    input:
      User-Agent                           : 'Opera/9.99 X11; U; NetBSD alpha; en-US; rv:1.8.1.6 Presto/2.2.15 Version/73.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Netbsd Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Alpha'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'NetBSD'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'NetBSD ??'
      OperatingSystemNameVersionMajor      : 'NetBSD ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.2.15'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.2.15'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '73.0'
      AgentVersionMajor                    : '73'
      AgentNameVersion                     : 'Opera 73.0'
      AgentNameVersionMajor                : 'Opera 73'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'No such version: Opera'


- test:
    input:
      User-Agent                           : 'Opera/9.99 X11; U; SunOS sun4u; en-US; rv:1.8.1.14 Presto/2.9.181 Version/74.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'SUN Microsystems Desktop'
      DeviceBrand                          : 'SUN Microsystems'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'SunOS'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'SunOS ??'
      OperatingSystemNameVersionMajor      : 'SunOS ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.9.181'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.9.181'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '74.0'
      AgentVersionMajor                    : '74'
      AgentNameVersion                     : 'Opera 74.0'
      AgentNameVersionMajor                : 'Opera 74'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'No such version: Opera'


- test:
    input:
      User-Agent                           : 'Opera/9.99 ZX-81; U; CP/M86; en-US; rv:1.8.0.1 Presto/2.12.388 Version/70.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Spectrum ZX-81'
      DeviceBrand                          : 'Spectrum'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'CP/M'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'CP/M ??'
      OperatingSystemNameVersionMajor      : 'CP/M ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Presto'
      LayoutEngineVersion                  : '2.12.388'
      LayoutEngineVersionMajor             : '2'
      LayoutEngineNameVersion              : 'Presto 2.12.388'
      LayoutEngineNameVersionMajor         : 'Presto 2'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera'
      AgentVersion                         : '70.0'
      AgentVersionMajor                    : '70'
      AgentNameVersion                     : 'Opera 70.0'
      AgentNameVersionMajor                : 'Opera 70'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'No such version: Opera'


# Mozilla 6 is also dodgy
- test:
    input:
      User-Agent                           : 'Mozilla/6.0 (Windows NT 7.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '7.2'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Windows NT 7.2'
      OperatingSystemNameVersionMajor      : 'Windows NT 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Gecko 45.0'
      LayoutEngineNameVersionMajor         : 'Gecko 45'
      LayoutEngineBuild                    : '20100101'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : '45.0'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Firefox 45.0'
      AgentNameVersionMajor                : 'Firefox 45'
      RemarkablePattern                    : 'No such version: Windows NT'


# "chrome" in lowercase; "X11; Windows x86_64" does not make sense
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (X11; Windows x86_64) AppleWebKit/536.11 (KHTML, like Gecko) chrome/22.0.1190.0 Safari/536.11'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows ??'
      OperatingSystemNameVersionMajor      : 'Windows ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '536.11'
      LayoutEngineVersionMajor             : '536'
      LayoutEngineNameVersion              : 'AppleWebKit 536.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 536'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '22.0.1190.0'
      AgentVersionMajor                    : '22'
      AgentNameVersion                     : 'Chrome 22.0.1190.0'
      AgentNameVersionMajor                : 'Chrome 22'
      RemarkablePattern                    : 'X11 and Windows'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en-us) AppleWebKit/412 (KHTML, like Gecko) Safari/412 Privoxy/3.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Apple Macintosh'
      DeviceBrand                          : 'Apple'
      DeviceCpu                            : 'PowerPC'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Mac OS'
      OperatingSystemVersion               : '10.?'
      OperatingSystemVersionMajor          : '10.?'
      OperatingSystemNameVersion           : 'Mac OS 10.?'
      OperatingSystemNameVersionMajor      : 'Mac OS 10.?'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '412'
      LayoutEngineVersionMajor             : '412'
      LayoutEngineNameVersion              : 'AppleWebKit 412'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 412'
      AgentClass                           : 'Browser'
      AgentName                            : 'Privoxy'
      AgentVersion                         : '3.0'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Privoxy 3.0'
      AgentNameVersionMajor                : 'Privoxy 3'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'Anonymized'

- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Android 12; Mobile; rv:84.0) Gecko/84.0 Firefox/84.0 PrivacyWall/84.0'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '12'
      OperatingSystemVersionMajor          : '12'
      OperatingSystemNameVersion           : 'Android 12'
      OperatingSystemNameVersionMajor      : 'Android 12'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '84.0'
      LayoutEngineVersionMajor             : '84'
      LayoutEngineNameVersion              : 'Gecko 84.0'
      LayoutEngineNameVersionMajor         : 'Gecko 84'
      LayoutEngineBuild                    : '84.0'
      AgentClass                           : 'Browser'
      AgentName                            : 'PrivacyWall'
      AgentVersion                         : '84.0'
      AgentVersionMajor                    : '84'
      AgentNameVersion                     : 'PrivacyWall 84.0'
      AgentNameVersionMajor                : 'PrivacyWall 84'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Android 11; Mobile; rv:70.0) Gecko/70.0 PrivacyWall/70.0a6'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '11'
      OperatingSystemVersionMajor          : '11'
      OperatingSystemNameVersion           : 'Android 11'
      OperatingSystemNameVersionMajor      : 'Android 11'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : '70.0'
      LayoutEngineVersionMajor             : '70'
      LayoutEngineNameVersion              : 'Gecko 70.0'
      LayoutEngineNameVersionMajor         : 'Gecko 70'
      LayoutEngineBuild                    : '70.0'
      AgentClass                           : 'Browser'
      AgentName                            : 'PrivacyWall'
      AgentVersion                         : '70.0a6'
      AgentVersionMajor                    : '70'
      AgentNameVersion                     : 'PrivacyWall 70.0a6'
      AgentNameVersionMajor                : 'PrivacyWall 70'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Chrome Privacy Preserving Prefetch Proxy'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Hacker'
      DeviceBrand                          : 'Hacker'
      DeviceVersion                        : 'Hacker'
      OperatingSystemClass                 : 'Hacker'
      OperatingSystemName                  : 'Hacker'
      OperatingSystemVersion               : 'Hacker'
      OperatingSystemVersionMajor          : 'Hacker'
      OperatingSystemNameVersion           : 'Hacker'
      OperatingSystemNameVersionMajor      : 'Hacker'
      LayoutEngineClass                    : 'Hacker'
      LayoutEngineName                     : 'Hacker'
      LayoutEngineVersion                  : 'Hacker'
      LayoutEngineVersionMajor             : 'Hacker'
      LayoutEngineNameVersion              : 'Hacker'
      LayoutEngineNameVersionMajor         : 'Hacker'
      AgentClass                           : 'Hacker'
      AgentName                            : 'Hacker'
      AgentVersion                         : 'Hacker'
      AgentVersionMajor                    : 'Hacker'
      AgentNameVersion                     : 'Hacker'
      AgentNameVersionMajor                : 'Hacker'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Edg/99.0.1150.55 Anonymisiert durch AlMiSoft Browser-Maulkorb 70231339'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '98.0'
      LayoutEngineVersionMajor             : '98'
      LayoutEngineNameVersion              : 'Blink 98.0'
      LayoutEngineNameVersionMajor         : 'Blink 98'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '99.0.1150.55'
      AgentVersionMajor                    : '99'
      AgentNameVersion                     : 'Edge 99.0.1150.55'
      AgentNameVersionMajor                : 'Edge 99'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36 Edg/92.0.902.78 Anonymisiert durch AlMiSoft Browser-Maulkorb 32431529'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '84.0'
      LayoutEngineVersionMajor             : '84'
      LayoutEngineNameVersion              : 'Blink 84.0'
      LayoutEngineNameVersionMajor         : 'Blink 84'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '92.0.902.78'
      AgentVersionMajor                    : '92'
      AgentNameVersion                     : 'Edge 92.0.902.78'
      AgentNameVersionMajor                : 'Edge 92'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      user_agent_string: 'http://Anonymouse.org/ (Unix)'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Anonymouse Robot'
      DeviceBrand                          : 'Anonymouse'
      OperatingSystemClass                 : 'Cloud'
      OperatingSystemName                  : 'Cloud'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Cloud ??'
      OperatingSystemNameVersionMajor      : 'Cloud ??'
      LayoutEngineClass                    : 'Unknown'
      LayoutEngineName                     : 'Unknown'
      LayoutEngineVersion                  : '??'
      LayoutEngineVersionMajor             : '??'
      AgentClass                           : 'Special'
      AgentName                            : 'http://Anonymouse.org/'
      AgentVersion                         : 'Unix'
      AgentVersionMajor                    : 'Unix'
      AgentNameVersion                     : 'http://Anonymouse.org/ Unix'
      AgentNameVersionMajor                : 'http://Anonymouse.org/ Unix'
      AgentInformationUrl                  : 'http://Anonymouse.org/'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/96.0.1054.57 Safari/537.22 anonymized by Abelssoft 31159949 GLS/91.10.4119.20'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '96.0'
      LayoutEngineVersionMajor             : '96'
      LayoutEngineNameVersion              : 'Blink 96.0'
      LayoutEngineNameVersionMajor         : 'Blink 96'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '96.0.1054.57'
      AgentVersionMajor                    : '96'
      AgentNameVersion                     : 'Chrome 96.0.1054.57'
      AgentNameVersionMajor                : 'Chrome 96'
      RemarkablePattern                    : 'Anonymized'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/96.0.1054.57 Safari/537.22 anonymized by Abelssoft 31159949 OpenWave/92.4.5283.84'
    expected:
      DeviceClass                          : 'Anonymized'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '8'
      OperatingSystemVersionMajor          : '8'
      OperatingSystemNameVersion           : 'Windows 8'
      OperatingSystemNameVersionMajor      : 'Windows 8'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '96.0'
      LayoutEngineVersionMajor             : '96'
      LayoutEngineNameVersion              : 'Blink 96.0'
      LayoutEngineNameVersionMajor         : 'Blink 96'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '96.0.1054.57'
      AgentVersionMajor                    : '96'
      AgentNameVersion                     : 'Chrome 96.0.1054.57'
      AgentNameVersionMajor                : 'Chrome 96'
      RemarkablePattern                    : 'Anonymized'


# https://github.com/nielsbasjes/yauaa/issues/848
# A messy second version is usually a normal client combined with an anti fingerprinting tool.
- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 10; ANA-LX4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.110 Mobile Safari/537.36/quickapp))'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Huawei ANA-LX4'
      DeviceBrand                          : 'Huawei'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '10'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Android 10'
      OperatingSystemNameVersionMajor      : 'Android 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '86.0'
      LayoutEngineVersionMajor             : '86'
      LayoutEngineNameVersion              : 'Blink 86.0'
      LayoutEngineNameVersionMajor         : 'Blink 86'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '86.0.4240.110'
      AgentVersionMajor                    : '86'
      AgentNameVersion                     : 'Chrome 86.0.4240.110'
      AgentNameVersionMajor                : 'Chrome 86'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36/AbXJL0Fq5KNyln588U7'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '100.0'
      LayoutEngineVersionMajor             : '100'
      LayoutEngineNameVersion              : 'Blink 100.0'
      LayoutEngineNameVersionMajor         : 'Blink 100'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '100.0.4896.88'
      AgentVersionMajor                    : '100'
      AgentNameVersion                     : 'Chrome 100.0.4896.88'
      AgentNameVersionMajor                : 'Chrome 100'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36/EAWinDTe5'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '103'
      LayoutEngineVersionMajor             : '103'
      LayoutEngineNameVersion              : 'Blink 103'
      LayoutEngineNameVersionMajor         : 'Blink 103'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '103'
      AgentVersionMajor                    : '103'
      AgentNameVersion                     : 'Chrome 103'
      AgentNameVersionMajor                : 'Chrome 103'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.56/UHYlQ2yl-59'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '>=10'
      OperatingSystemVersionMajor          : '>=10'
      OperatingSystemNameVersion           : 'Windows >=10'
      OperatingSystemNameVersionMajor      : 'Windows >=10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '107'
      LayoutEngineVersionMajor             : '107'
      LayoutEngineNameVersion              : 'Blink 107'
      LayoutEngineNameVersionMajor         : 'Blink 107'
      AgentClass                           : 'Browser'
      AgentName                            : 'Edge'
      AgentVersion                         : '107'
      AgentVersionMajor                    : '107'
      AgentNameVersion                     : 'Edge 107'
      AgentNameVersionMajor                : 'Edge 107'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36/8vGeL2cj-43'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '??'
      OperatingSystemVersionMajor          : '??'
      OperatingSystemNameVersion           : 'Windows NT ??'
      OperatingSystemNameVersionMajor      : 'Windows NT ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '108'
      LayoutEngineVersionMajor             : '108'
      LayoutEngineNameVersion              : 'Blink 108'
      LayoutEngineNameVersionMajor         : 'Blink 108'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '108'
      AgentVersionMajor                    : '108'
      AgentNameVersion                     : 'Chrome 108'
      AgentNameVersionMajor                : 'Chrome 108'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36/LfbJP46o-14'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '76.0'
      LayoutEngineVersionMajor             : '76'
      LayoutEngineNameVersion              : 'Blink 76.0'
      LayoutEngineNameVersionMajor         : 'Blink 76'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '76.0.3809.100'
      AgentVersionMajor                    : '76'
      AgentNameVersion                     : 'Chrome 76.0.3809.100'
      AgentNameVersionMajor                : 'Chrome 76'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36/Ggaxc2uX-3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : '10.0'
      OperatingSystemVersionMajor          : '10'
      OperatingSystemNameVersion           : 'Windows 10.0'
      OperatingSystemNameVersionMajor      : 'Windows 10'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '75.0'
      LayoutEngineVersionMajor             : '75'
      LayoutEngineNameVersion              : 'Blink 75.0'
      LayoutEngineNameVersionMajor         : 'Blink 75'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '75.0.3770.142'
      AgentVersionMajor                    : '75'
      AgentNameVersion                     : 'Chrome 75.0.3770.142'
      AgentNameVersionMajor                : 'Chrome 75'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:x.x.x) Gecko/20041107 Firefox/x.x'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'XP'
      OperatingSystemVersionMajor          : 'XP'
      OperatingSystemNameVersion           : 'Windows XP'
      OperatingSystemNameVersionMajor      : 'Windows XP'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Gecko'
      LayoutEngineVersion                  : 'x.x.x'
      LayoutEngineVersionMajor             : 'x'
      LayoutEngineNameVersion              : 'Gecko x.x.x'
      LayoutEngineNameVersionMajor         : 'Gecko x'
      LayoutEngineBuild                    : '20041107'
      AgentClass                           : 'Browser'
      AgentName                            : 'Firefox'
      AgentVersion                         : 'x.x'
      AgentVersionMajor                    : 'x'
      AgentNameVersion                     : 'Firefox x.x'
      AgentNameVersionMajor                : 'Firefox x'
      AgentLanguage                        : 'English (United States)'
      AgentLanguageCode                    : 'en-us'
      AgentSecurity                        : 'Strong security'
      RemarkablePattern                    : 'Not a version'


- test:
    input:
      User-Agent                           : 'Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemVersionMajor          : '7'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      OperatingSystemNameVersionMajor      : 'Android 7'
      OperatingSystemVersionBuild          : 'N6F26U'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.36'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.36'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chrome'
      AgentVersion                         : '%s'
      AgentVersionMajor                    : '%s'
      AgentNameVersion                     : 'Chrome %s'
      AgentNameVersionMajor                : 'Chrome %s'
      RemarkablePattern                    : 'Not a version'

